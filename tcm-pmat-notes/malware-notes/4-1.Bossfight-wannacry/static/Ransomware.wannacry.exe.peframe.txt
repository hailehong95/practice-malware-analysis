
--------------------------------------------------------------------------------
File Information (time: 0:00:10.640660)
--------------------------------------------------------------------------------
filename         Ransomware.wannacry.exe.malz
filetype         PE32 executable (GUI) Intel 80386, for MS Windows
filesize         3723264
hash sha256      24d004a104d4d54034dbcffc2a4b19a11f39008a575aa614ea04703480b1022c
virustotal       /
imagebase        0x400000
entrypoint       0x9a16
imphash          9ecee117164e0b870a53dd187cdd7174
datetime         2010-11-20 09:03:08
dll              False
directories      import, tls, relocations, resources *
sections         .rdata, .text *, .data *, .rsrc *
features         mutex, packer, crypto


--------------------------------------------------------------------------------
Yara Plugins
--------------------------------------------------------------------------------
IsPE32
IsWindowsGUI
IsPacked
HasRichSignature
CRC32 poly Constant
CRC32 table
RijnDael AES
RijnDael AES CHAR
RijnDael AES LONG


--------------------------------------------------------------------------------
Behavior
--------------------------------------------------------------------------------
anti dbg
Xor
win registry
win files operation


--------------------------------------------------------------------------------
Crypto
--------------------------------------------------------------------------------
CRC32 poly Constant
CRC32 table
RijnDael AES
RijnDael AES CHAR
RijnDael AES LONG


--------------------------------------------------------------------------------
Packer
--------------------------------------------------------------------------------
Microsoft Visual Cpp v60
Microsoft Visual Cpp v50v60 MFC additional
Microsoft Visual Cpp 50
Microsoft Visual Cpp v50v60 MFC
Microsoft Visual Cpp


--------------------------------------------------------------------------------
Mutex Api
--------------------------------------------------------------------------------
WaitForSingleObject


--------------------------------------------------------------------------------
Sections Suspicious
--------------------------------------------------------------------------------
.text            6.13
.data            6.10
.rsrc            7.99


--------------------------------------------------------------------------------
Metadata
--------------------------------------------------------------------------------
CompanyName      Microsoft Corporation
FileDescription  Microsoft® Disk Defragmenter
FileVersion      6.1.7601.17514 (win7sp1_rtm.101119-1850)
InternalName     lhdfrgui.exe
LegalCopyright   © Microsoft Corporation. All rights reserved.
OriginalFilename lhdfrgui.exe
ProductName      Microsoft® Windows® Operating System
ProductVersion   6.1.7601.17514


--------------------------------------------------------------------------------
Import function
--------------------------------------------------------------------------------
KERNEL32.dll     32
ADVAPI32.dll     11
WS2_32.dll       13
MSVCP60.dll      2
iphlpapi.dll     2
WININET.dll      3
MSVCRT.dll       28


--------------------------------------------------------------------------------
Possibile Breakpoint
--------------------------------------------------------------------------------
CloseHandle
CreateFileA
CreateServiceA
ExitProcess
FindResourceA
GetFileSize
GetModuleFileNameA
GetModuleHandleA
GetModuleHandleW
GetProcAddress
GetStartupInfoA
GetTickCount
InternetCloseHandle
InternetOpenA
InternetOpenUrlA
LockResource
ReadFile
Sleep
StartServiceA
StartServiceCtrlDispatcherA
WSAStartup
WaitForSingleObject
closesocket
connect
recv
send
socket


--------------------------------------------------------------------------------
Url
--------------------------------------------------------------------------------
http://www.iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com


--------------------------------------------------------------------------------
File
--------------------------------------------------------------------------------
KERNEL32.dll     Library
ADVAPI32.dll     Library
WS2_32.dll       Library
MSVCP60.dll      Library
iphlpapi.dll     Library
WININET.dll      Library
MSVCRT.dll       Library
launcher.dll     Library
mssecsvc.exe     Executable
msvcrtd.dll      Library
H.msvcrt.dll     Library
tasksche.exe     Executable
USER32.dll       Library
SHELL32.dll      Library
OLEAUT32.dll     Library
.avIZ$n.Db       Database
taskdl.exe       Executable
taskse.exe       Executable


--------------------------------------------------------------------------------
Fuzzing
--------------------------------------------------------------------------------
String too long
