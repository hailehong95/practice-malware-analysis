md5                     c211704777e168a5151de79dc87ffac7
sha1                    1f688b4872f8a740872b5cb6d58e2b9c7103143a
sha256                  481eae82ac4cd1a9cfadc026a628b18d7b4c54f50385d28c505fbcb3e999b8b0
path                    RAT.Unknown2.exe.malz
timestamp               2022-08-04T10:52:06.614386
capa version            v3.2.0-0-gd9d72ad
os                      windows
format                  pe
arch                    amd64
extractor               VivisectFeatureExtractor
base address            0x400000
rules                   /tmp/_MEIb8dexr/rules
function count          422
library function count  3
total feature count     19216

compiled with Nim
namespace  compiler/nim
author     michael.hunhoff@mandiant.com
scope      file
examples   580c37831fe98a254eb6c61c692c70d8.exe_
or:
  substring: NimMain
    - "NimMain" @ 0x5F306
    - "NimMainInner" @ 0x6B7EB
    - "NimMainModule" @ 0x6B739
  substring: NimMainModule
    - "NimMainModule" @ 0x6B739
  substring: NimMainInner
    - "NimMainInner" @ 0x6B7EB
  substring: io.nim
    - "io.nim" @ 0xE048
    - "stdlib_io.nim.c" @ 0x5B3D0
  substring: fatal.nim
    - "fatal.nim" @ 0xE00F, 0xE1E8
  substring: system.nim
    - "stdlib_system.nim.c" @ 0x692E5

contain a resource (.rsrc) section
namespace  executable/pe/section/rsrc
author     moritz.raabe@mandiant.com
scope      file
examples   A933A1A402775CFA94B6BEE0963F4B46:0x41fd25
section: .rsrc @ 0x42F000

contain a thread local storage (.tls) section
namespace  executable/pe/section/tls
author     michael.hunhoff@mandiant.com
scope      file
examples   Practical Malware Analysis Lab 16-02.exe_
section: .tls @ 0x42E000

write file on Windows (3 matches)
namespace  host-interaction/file-system/write
author     william.ballenthin@mandiant.com
scope      function
mbc        File System::Writes File [C0052]
examples   Practical Malware Analysis Lab 01-04.exe_:0x4011FC, 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x1400025C4
function @ 0x401E2F
  and:
    os: windows
    or:
      api: fwrite @ 0x401E70
function @ 0x401FC7
  and:
    os: windows
    or:
      api: fwrite @ 0x401FF9
function @ 0x40D3A0
  and:
    os: windows
    or:
      api: fwrite @ 0x40D3E2

get thread local storage value
namespace  host-interaction/process
author     michael.hunhoff@mandiant.com
scope      function
function @ 0x40DDE0
  and:
    api: kernel32.TlsGetValue @ 0x40DE12

allocate RWX memory
namespace  host-interaction/process/inject
author     moritz.raabe@mandiant.com
scope      basic block
mbc        Memory::Allocate Memory [C0007]
examples   Practical Malware Analysis Lab 03-03.exe_:0x4010EA, 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA
basic block @ 0x40D570 in function 0x40D410
  and:
    match: allocate memory @ 0x40D570
      or:
        api: kernel32.VirtualProtect @ 0x40D592
    number: 0x40 = PAGE_EXECUTE_READWRITE @ 0x40D57A

terminate process
namespace  host-interaction/process/terminate
author     moritz.raabe@mandiant.com
scope      function
mbc        Process::Terminate Process [C0018]
examples   C91887D861D9BD4A5872249B641BC9F9:0x401A77, 9B7CCAA2AE6A5B96E3110EBCBC4311F6:0x10010307
function @ 0x40D0C0
  and:
    or:
      api: kernel32.TerminateProcess @ 0x40D192

parse PE header (2 matches)
namespace  load-code/pe
author     moritz.raabe@mandiant.com
scope      function
att&ck     Execution::Shared Modules [T1129]
examples   9324D1A8AE37A36AE560C37448C9705A:0x403DD0
function @ 0x401010
  and:
    os: windows
    and:
      mnemonic: cmp @ 0x401051, 0x40105F, 0x4010A0, 0x4010C4, and 3 more...
      or:
        number: 0x4550 = IMAGE_NT_SIGNATURE (PE) @ 0x40105F
      or:
        number: 0x5A4D = IMAGE_DOS_SIGNATURE (MZ) @ 0x401051
function @ 0x40E060
  and:
    os: windows
    and:
      mnemonic: cmp @ 0x40E04A, 0x40E054, 0x40E060
      or:
        number: 0x4550 = IMAGE_NT_SIGNATURE (PE) @ 0x40E04A
      or:
        number: 0x5A4D = IMAGE_DOS_SIGNATURE (MZ) @ 0x40E060



